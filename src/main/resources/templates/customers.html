<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Management | Movie Ticket System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        /* Modern Base Styles */
        :root {
            --primary: #e63946;
            --primary-dark: #c1121f;
            --secondary: #457b9d;
            --secondary-dark: #1d3557;
            --dark: #1e293b;
            --darker: #0f172a;
            --light: #f8f9fa;
            --lighter: #ffffff;
            --accent: #f43f5e;
            --text: #333333;
            --text-light: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 14px;
            --sidebar-width: 220px;
            /* Reduced from 280px to match admin-home */
            --mobile-sidebar-width: 280px;
            /* Same for mobile */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--light);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            display: grid;
            grid-template-areas:
                "header header"
                "sidebar content";
            grid-template-columns: var(--sidebar-width) 1fr;
            min-height: 100vh;
        }

        @media (max-width: 992px) {
            .container {
                grid-template-areas:
                    "header"
                    "content";
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .mobile-menu-btn {
                display: block !important;
            }
        }

        /* Enhanced Header Styles */
        header {
            grid-area: header;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: var(--lighter);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
            transition: var(--transition);
        }

        .scrolled-header {
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.95);
        }

        h1 {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: -0.5px;
        }

        h1 i {
            font-size: 1.4rem;
            color: var(--primary);
        }

        .user-controls {
            display: flex;
            gap: 12px;
        }

        button {
            padding: 10px 18px;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            font-size: 0.95rem;
            box-shadow: var(--shadow-sm);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        button:active {
            transform: translateY(0);
        }

        #loginBtn {
            background-color: var(--secondary);
            color: white;
        }

        #registerBtn {
            background-color: var(--secondary-dark);
            color: white;
        }

        #profileBtn {
            background-color: var(--secondary);
            color: white;
        }

        #logoutBtn {
            background-color: var(--primary);
            color: white;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--primary);
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .mobile-menu-btn:hover {
            background-color: rgba(230, 57, 70, 0.1);
        }

        /* Modern Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: #1a1a2e;
            color: white;
            height: 100vh;
            position: sticky;
            top: 0;
            padding: 1rem 0;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar li {
            margin: 0.25rem 0;
            position: relative;
        }

        .sidebar a {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem 1.5rem;
            color: #e2e8f0;
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }

        .sidebar a:hover {
            background-color: #334155;
            color: white;
            border-left-color: var(--accent);
        }

        .sidebar li.active a {
            background-color: #334155;
            color: white;
            border-left-color: var(--accent);
        }

        .sidebar i {
            width: 1.5rem;
            font-size: 1.1rem;
            text-align: center;
            color: #94a3b8;
        }

        .sidebar li.active i,
        .sidebar a:hover i {
            color: white;
        }

        /* Content Area */
        .content {
            grid-area: content;
            padding: 30px;
            background-color: var(--light);
            min-height: calc(100vh - 70px);
        }

        /* Modern Search Bar */
        .search-bar {
            display: flex;
            margin-bottom: 30px;
            position: relative;
            max-width: 500px;
        }

        .search-bar input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius-md);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--lighter);
            box-shadow: var(--shadow-sm);
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(230, 57, 70, 0.2);
        }

        .search-bar button {
            position: absolute;
            right: 5px;
            top: 5px;
            padding: 7px 12px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
        }

        .search-bar button:hover {
            background-color: var(--primary-dark);
            transform: none;
        }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            background-color: var(--lighter);
            padding: 20px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
            font-size: 0.9rem;
        }

        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius-sm);
            font-size: 0.95rem;
            transition: var(--transition);
            background-color: var(--lighter);
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(230, 57, 70, 0.2);
        }

        /* Stats Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background-color: var(--lighter);
            border-radius: var(--radius-md);
            padding: 25px;
            box-shadow: var(--shadow-sm);
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--accent));
        }

        .card h3 {
            font-size: 1rem;
            color: var(--text-light);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .card p {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text);
            margin: 10px 0;
        }

        /* Different colors for each card */
        .card:nth-child(1)::before {
            background: linear-gradient(to bottom, var(--primary), #f8ad9d);
        }

        .card:nth-child(2)::before {
            background: linear-gradient(to bottom, var(--secondary), #a8dadc);
        }

        .card:nth-child(3)::before {
            background: linear-gradient(to bottom, var(--success), #b7efc5);
        }

        .card:nth-child(4)::before {
            background: linear-gradient(to bottom, var(--warning), #fde4cf);
        }

        /* Customer List Section */
        .customer-list {
            background-color: var(--lighter);
            border-radius: var(--radius-md);
            padding: 25px;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .customer-list:hover {
            box-shadow: var(--shadow-md);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-header h2 {
            font-size: 1.6rem;
            color: var(--text);
            padding-bottom: 10px;
            position: relative;
            font-weight: 600;
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 2px;
        }

        /* Action Buttons */
        .action-btn {
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.85rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            border: none;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .view-btn {
            background-color: var(--secondary);
            color: white;
        }

        .edit-btn {
            background-color: var(--success);
            color: white;
        }

        .ban-btn {
            background-color: var(--danger);
            color: white;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: transparent;
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        th,
        td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        th {
            background-color: var(--primary);
            color: white;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }

        tr {
            transition: var(--transition);
        }

        tr:not(:first-child):hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-active {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-banned {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .status-inactive {
            background-color: rgba(156, 163, 175, 0.1);
            color: var(--text-light);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 25px;
            gap: 8px;
        }

        .pagination button {
            padding: 8px 16px;
            border: 1px solid var(--light-gray);
            background-color: white;
            cursor: pointer;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            min-width: 40px;
            transition: var(--transition);
        }

        .pagination button.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .pagination button:hover:not(.active) {
            background-color: var(--light);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background-color: var(--lighter);
            margin: 8% auto;
            padding: 30px;
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 800px;
            position: relative;
            box-shadow: var(--shadow-lg);
            animation: slideDown 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .close {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .close:hover {
            color: var(--primary);
            transform: rotate(90deg);
        }

        .modal h2 {
            margin-bottom: 25px;
            color: var(--text);
            font-size: 1.8rem;
            font-weight: 600;
            position: relative;
            padding-bottom: 10px;
        }

        .modal h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--accent));
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--lighter);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(230, 57, 70, 0.2);
        }

        .form-group select[multiple] {
            height: 120px;
        }

        .form-group small {
            display: block;
            margin-top: 8px;
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .modal-content button[type="submit"] {
            width: 100%;
            padding: 14px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            margin-top: 15px;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .modal-content button[type="submit"]:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            opacity: 0.95;
        }

        /* Customer Details Grid */
        .customer-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .detail-group {
            margin-bottom: 15px;
        }

        .detail-label {
            font-weight: 500;
            color: var(--text-light);
            margin-bottom: 5px;
            font-size: 0.85rem;
        }

        .detail-value {
            font-size: 1rem;
            color: var(--text);
            font-weight: 500;
        }

        /* Responsive Table */
        @media (max-width: 768px) {
            table {
                display: block;
            }

            thead {
                display: none;
            }

            tr {
                display: block;
                margin-bottom: 15px;
                border: 1px solid #ddd;
                border-radius: var(--radius-md);
                overflow: hidden;
                box-shadow: var(--shadow-sm);
            }

            td {
                display: flex;
                justify-content: space-between;
                padding: 12px 15px;
                border-bottom: 1px solid #eee;
            }

            td:before {
                content: attr(data-label);
                font-weight: 600;
                margin-right: 10px;
                color: var(--text);
            }

            td:last-child {
                border-bottom: none;
            }

            .customer-actions {
                flex-direction: row !important;
                justify-content: flex-end;
            }
        }

        /* Enhanced Mobile Sidebar */
        .mobile-sidebar {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background-color: var(--darker);
            z-index: 1000;
            transition: var(--transition);
            overflow-y: auto;
            box-shadow: 5px 0 25px rgba(0, 0, 0, 0.3);
        }

        .mobile-sidebar.show {
            left: 0;
        }

        .mobile-sidebar-header {
            padding: 25px;
            background-color: rgba(15, 23, 42, 0.9);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .mobile-sidebar-header h3 {
            color: white;
            margin: 0;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }

        .mobile-sidebar-header .close-sidebar {
            background: none;
            border: none;
            color: var(--accent);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
            padding: 5px;
            border-radius: 50%;
        }

        .mobile-sidebar-header .close-sidebar:hover {
            background-color: rgba(244, 63, 94, 0.1);
            transform: rotate(90deg);
        }

        .mobile-sidebar ul {
            list-style: none;
            padding: 15px 0;
            margin: 0;
        }

        .mobile-sidebar li {
            margin: 0;
        }

        .mobile-sidebar a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 16px 30px;
            color: #e2e8f0;
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            transition: var(--transition);
            border-left: 4px solid transparent;
        }

        .mobile-sidebar a:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: white;
            padding-left: 35px;
        }

        .mobile-sidebar li.active a {
            background-color: rgba(244, 63, 94, 0.15);
            color: white;
            border-left-color: var(--accent);
        }

        .mobile-sidebar i {
            width: 24px;
            font-size: 1.1rem;
            text-align: center;
            color: #94a3b8;
        }

        .mobile-sidebar li.active i,
        .mobile-sidebar a:hover i {
            color: white;
        }

        .mobile-sidebar-footer {
            padding: 20px;
            text-align: center;
            color: #64748b;
            font-size: 0.8rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 20px;
        }

        /* Overlay Styles */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 999;
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }

        .overlay.show {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            z-index: 99;
            transition: var(--transition);
        }

        .fab:hover {
            transform: scale(1.1) translateY(-5px);
            background-color: var(--primary-dark);
        }

        /* Responsive Adjustments */
        @media (max-width: 992px) {
            .sidebar {
                display: none;
            }

            .mobile-menu-btn {
                display: block;
            }

            .content {
                padding: 20px;
            }

            header {
                padding: 15px 20px;
            }
        }

        @media (max-width: 576px) {
            .mobile-sidebar {
                width: 85%;
                left: -85%;
            }

            .mobile-sidebar a {
                padding: 14px 25px;
                font-size: 0.95rem;
            }

            .user-controls button .btn-text {
                display: none;
            }

            .stats-cards {
                grid-template-columns: 1fr;
            }

            .card {
                padding: 20px;
            }

            .filter-bar {
                flex-direction: column;
                gap: 15px;
            }

            .filter-group {
                min-width: 100%;
            }

            .customer-actions {
                flex-direction: column !important;
                gap: 8px;
            }

            .action-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header id="mainHeader">
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            <h1><i class="fas fa-ticket-alt"></i> Movie Ticket System</h1>
            <div class="user-controls">
                <!-- Show admin profile if logged in (mobile session attribute exists) -->
                <div th:if="${session.mobile != null}" style="display: flex; gap: 10px;">
                    <button id="logoutBtn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="btn-text">Logout</span>
                    </button>

                    <script>
                        function logout() {
                            fetch('/logout', {
                                method: 'GET',
                                credentials: 'same-origin' // This ensures cookies/session are included
                            })
                                .then(response => {
                                    if (response.redirected) {
                                        window.location.href = response.url; // Redirect to the home page
                                    }
                                })
                                .catch(error => {
                                    console.error('Logout error:', error);
                                });
                        }
                    </script>
                </div>
            </div>
        </header>

        <nav class="sidebar">
            <ul>
                <li><a href="/admin-home"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="/movies"><i class="fas fa-film"></i> Movies</a></li>
                <li><a th:href="@{/screenings}"><i class="fas fa-calendar-alt"></i> Screenings</a></li>
                <li class="active"><a href="/customers"><i class="fas fa-users"></i> Customers</a></li>
                <li><a href="/reports"><i class="fas fa-chart-bar"></i> Reports</a></li>
                <li><a href="/settings"><i class="fas fa-cog"></i> Settings</a></li>
            </ul>
        </nav>

        <!-- Mobile Sidebar -->
        <div class="mobile-sidebar" id="mobileSidebar">
            <div class="mobile-sidebar-header">
                <h3><i class="fas fa-ticket-alt"></i> Menu</h3>
                <button class="close-sidebar" id="closeSidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <ul>
                <li><a href="/admin-home"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="/movies"><i class="fas fa-film"></i> Movies</a></li>
                <li><a th:href="@{/screenings}"><i class="fas fa-calendar-alt"></i> Screenings</a></li>
                <li class="active"><a href="/customers"><i class="fas fa-users"></i> Customers</a></li>
                <li><a href="/reports"><i class="fas fa-chart-bar"></i> Reports</a></li>
                <li><a href="/settings"><i class="fas fa-cog"></i> Settings</a></li>
            </ul>
            <div class="mobile-sidebar-footer">
                Movie Ticket System &copy; <span id="currentYear"></span>
            </div>
        </div>
        <div class="overlay" id="overlay"></div>

        <main class="content">
            <div class="search-bar">
                <input type="text" placeholder="Search customers by name, email, or phone..." id="customerSearch">
                <button id="searchBtn"><i class="fas fa-search"></i></button>
            </div>

            <div class="filter-bar">
                <div class="filter-group">
                    <label for="statusFilter">Status</label>
                    <select id="statusFilter">
                        <option value="all">All Statuses</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="banned">Banned</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="dateFilter">Joined Date</label>
                    <select id="dateFilter">
                        <option value="all">All Time</option>
                        <option value="today">Today</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                        <option value="year">This Year</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sortBy">Sort By</label>
                    <select id="sortBy">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                        <option value="name_asc">Name (A-Z)</option>
                        <option value="name_desc">Name (Z-A)</option>
                        <option value="bookings">Most Bookings</option>
                    </select>
                </div>
                <button class="action-btn edit-btn" onclick="applyFilters()" style="align-self: flex-end;">
                    <i class="fas fa-filter"></i> <span class="btn-text">Apply Filters</span>
                </button>
            </div>

            <div class="stats-cards">
                <div class="card">
                    <h3>Total Customers</h3>
                    <p th:text="${users.size()}">0</p>
                    <i class="fas fa-users" style="font-size: 1.5rem; color: var(--primary);"></i>
                </div>
                <div class="card">
                    <h3>Active Customers</h3>
                    <p th:text="${users.?[status == 'Active'].size()}">0</p>
                    <i class="fas fa-user-check" style="font-size: 1.5rem; color: var(--secondary);"></i>
                </div>
                <div class="card">
                    <h3>New This Month</h3>
                    <p th:text="${newuser}">0</p>
                    <i class="fas fa-user-plus" style="font-size: 1.5rem; color: var(--success);"></i>
                </div>
                <div class="card">
                    <h3>Avg. Bookings</h3>
                    <p th:text="${AverageBooking}">0</p>
                    <i class="fas fa-ticket-alt" style="font-size: 1.5rem; color: var(--warning);"></i>
                </div>
            </div>

            <div class="customer-list">
                <div class="section-header">
                    <h2>Customer List</h2>
                    <button class="action-btn edit-btn" onclick="showAddCustomerModal()">
                        <i class="fas fa-plus"></i> <span class="btn-text">Add Customer</span>
                    </button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Joined</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="user : ${users}">
                            <td data-label="ID" th:text="${user.id}"></td>
                            <td data-label="Name" th:text="${user.firstname} + ' ' + ${user.lastname}">John Doe</td>
                            <td data-label="Email" th:text="${user.email}">john.doe@example.com</td>
                            <td data-label="Phone" th:text="${user.mobile}">+1 555-123-4567</td>
                            <td data-label="Joined" th:text="${#temporals.format(user.createdAt, 'MM/dd/yyyy')}">
                                05/15/2023</td>
                            <td data-label="Status">
                                <span th:classappend="'status-badge ' + ${user.status == 'Active' ? 'status-active' : 
                                    (user.status == 'Banned' ? 'status-banned' : 'status-inactive')}"
                                    th:text="${user.status}">Active</span>
                            </td>
                            <td data-label="Actions" class="customer-actions">
                                <button class="action-btn view-btn"
                                    th:onclick="'viewCustomerDetails(\'' + ${user.id} + '\')'">
                                    <i class="fas fa-eye"></i> <span class="action-text">View</span>
                                </button>
                                <button class="action-btn edit-btn" th:onclick="'editCustomer(\'' + ${user.id} + '\')'">
                                    <i class="fas fa-edit"></i> <span class="action-text">Edit</span>
                                </button>
                                <button th:if="${user.status == 'Active'}" class="action-btn ban-btn"
                                    th:onclick="'banCustomer(\'' + ${user.id} + '\')'">
                                    <i class="fas fa-ban"></i> <span class="action-text">Ban</span>
                                </button>
                                <button th:if="${user.status == 'Banned'}" class="action-btn edit-btn"
                                    th:onclick="'unbanCustomer(\'' + ${user.id} + '\')'">
                                    <i class="fas fa-check"></i> <span class="action-text">Unban</span>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!-- <div class="pagination">
                    <button disabled>Previous</button>
                    <button class="active">1</button>
                    <button>2</button>
                    <button>3</button>
                    <button>Next</button>
                </div> -->
            </div>
        </main>

        <!-- Floating Action Button -->
        <div class="fab" id="fabBtn">
            <i class="fas fa-plus"></i>
        </div>

        <!-- Customer Details Modal -->
        <div class="modal" id="customerDetailsModal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Customer Details</h2>

                <div class="customer-details-card">
                    <div class="customer-details-grid">
                        <div class="detail-group">
                            <span class="detail-label">Customer ID</span>
                            <span class="detail-value" id="detail-id"></span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Full Name</span>
                            <span class="detail-value" id="detail-name">John Doe</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Email</span>
                            <span class="detail-value" id="detail-email">john.doe@example.com</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Phone</span>
                            <span class="detail-value" id="detail-phone">+1 555-123-4567</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Date of Birth</span>
                            <span class="detail-value" id="detail-dob">1985-07-15</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Joined Date</span>
                            <span class="detail-value" id="detail-joined">2023-05-15</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Status</span>
                            <span class="detail-value"><span class="status-badge status-active"
                                    id="detail-status">Active</span></span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Total Bookings</span>
                            <span class="detail-value" id="detail-bookings">12</span>
                        </div>
                        <div class="detail-group">
                            <span class="detail-label">Total Spent</span>
                            <span class="detail-value" id="detail-spent">$245.50</span>
                        </div>
                    </div>
                </div>

                <div class="booking-history">
                    <h3>Booking History</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Booking ID</th>
                                <th>Movie</th>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Seats</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody id="bookingHistory">
                            <tr>
                                <td colspan="6" style="text-align: center;">Loading booking history...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Customer Form Modal -->
        <div class="modal" id="customerFormModal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2 id="formModalTitle">Add New Customer</h2>
                <form id="customerForm">
                    <input type="hidden" id="customerId" name="id">

                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" name="firstname" placeholder="First Name" required>
                    </div>

                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" name="lastname" placeholder="Last Name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" placeholder="Email" required>
                    </div>

                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="tel" id="phone" name="mobile" placeholder="Phone Number">
                    </div>

                    <div class="form-group">
                        <label for="location">Location</label>
                        <input type="text" id="location" name="location" placeholder="Location">
                    </div>

                    <div class="form-group">
                        <label for="profileUrl">Profile Picture URL</label>
                        <input type="url" id="profileUrl" name="profileUrl"
                            placeholder="https://example.com/profile.jpg" pattern="https?://.+"
                            onchange="verifyProfileImage(this.value)">
                        <div id="profileImagePreview" style="margin-top: 10px; display: none;">
                            <img id="profileImage" src="" alt="Profile Preview"
                                style="max-width: 100px; max-height: 100px; border-radius: 50%;">
                            <span id="profileImageStatus" style="margin-left: 10px;"></span>
                        </div>
                    </div>

                    <div class="form-group" id="statusField">
                        <label for="status">Status</label>
                        <select id="status" name="status">
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                            <option value="Banned">Banned</option>
                        </select>
                    </div>

                    <!-- Password Section (only shown when adding new customer) -->
                    <div class="form-group" id="passwordField">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" placeholder="Password"
                            oninput="checkPasswordStrength(this.value)">
                        <div id="passwordStrengthMeter"
                            style="height: 5px; background: #eee; margin-top: 5px; border-radius: 3px;">
                            <div id="passwordStrengthBar"
                                style="height: 100%; width: 0%; border-radius: 3px; transition: width 0.3s;"></div>
                        </div>
                        <small id="passwordStrengthText" style="color: #666; font-size: 0.8rem;">Password strength: Very
                            Weak</small>

                        <div style="margin-top: 10px;">
                            <label for="confirmPassword">Confirm Password</label>
                            <input type="password" id="confirmPassword" placeholder="Confirm Password"
                                oninput="checkPasswordMatch()">
                            <small id="passwordMatchText" style="color: #666; font-size: 0.8rem;"></small>
                        </div>
                    </div>

                    <!-- Form Action Buttons (will be dynamically populated) -->
                    <div id="formActionButtons"
                        style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                        <!-- Buttons will be inserted here by JavaScript -->
                    </div>
                </form>
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div class="modal" id="confirmModal">
            <div class="modal-content" style="max-width: 500px;">
                <span class="close">&times;</span>
                <h2 id="confirmTitle">Confirm Action</h2>
                <p id="confirmMessage">Are you sure you want to perform this action?</p>
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                    <button class="action-btn" onclick="document.getElementById('confirmModal').style.display='none'"
                        style="background-color: var(--text-light);">Cancel</button>
                    <button class="action-btn ban-btn" id="confirmActionBtn">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Mobile Sidebar Functionality
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileSidebar = document.getElementById('mobileSidebar');
        const closeSidebar = document.getElementById('closeSidebar');
        const overlay = document.getElementById('overlay');
        const fabBtn = document.getElementById('fabBtn');
        const mainHeader = document.getElementById('mainHeader');
        const searchInput = document.getElementById('customerSearch');
        const searchBtn = document.getElementById('searchBtn');

        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Toggle sidebar
        function toggleSidebar() {
            mobileSidebar.classList.toggle('show');
            overlay.classList.toggle('show');
            document.body.classList.toggle('no-scroll');
        }

        // Event listeners
        mobileMenuBtn.addEventListener('click', toggleSidebar);
        closeSidebar.addEventListener('click', toggleSidebar);
        overlay.addEventListener('click', toggleSidebar);

        // Close sidebar when clicking on a link
        document.querySelectorAll('.mobile-sidebar a').forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth <= 992) {
                    toggleSidebar();
                }
            });
        });

        // FAB button click handler
        fabBtn.addEventListener('click', function () {
            showAddCustomerModal();
        });

        // Search functionality
        searchBtn.addEventListener('click', function () {
            const searchTerm = searchInput.value.trim();
            if (searchTerm) {
                applyFilters();
            }
        });

        // Allow search on Enter key
        searchInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                applyFilters();
            }
        });

        // Header scroll effect
        window.addEventListener('scroll', function () {
            if (window.scrollY > 10) {
                mainHeader.classList.add('scrolled-header');
            } else {
                mainHeader.classList.remove('scrolled-header');
            }
        });

        // Modal functionality
        document.querySelectorAll('.close').forEach(button => {
            button.addEventListener('click', function () {
                this.closest('.modal').style.display = 'none';
            });
        });

        window.addEventListener('click', function (event) {
            if (event.target.className === 'modal') {
                event.target.style.display = 'none';
            }
        });

        // Prevent body scroll when sidebar is open
        document.body.classList.remove('no-scroll');

        // Add hover effect to cards dynamically
        document.querySelectorAll('.card').forEach((card, index) => {
            card.addEventListener('mouseenter', function () {
                this.style.transform = 'translateY(-5px)';
                this.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.1)';
            });

            card.addEventListener('mouseleave', function () {
                this.style.transform = '';
                this.style.boxShadow = '';
            });

            // Add delay animation
            this.style.animationDelay = `${index * 0.1}s`;
        });

        // Add animation to table rows
        document.querySelectorAll('tbody tr').forEach((row, index) => {
            row.style.opacity = '0';
            row.style.animation = `fadeIn 0.5s ease-out ${index * 0.1}s forwards`;
        });

        // Helper function to format just the date part
        function formatDateOnly(dateTimeString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateTimeString).toLocaleDateString(undefined, options);
        }

        // Helper function to format just the time part
        function formatTimeOnly(dateTimeString) {
            const options = { hour: '2-digit', minute: '2-digit', hour12: true };
            return new Date(dateTimeString).toLocaleTimeString(undefined, options);
        }

        // ========== CUSTOMER SPECIFIC FUNCTIONS ========== //

        // Function to show Add Customer modal
        function showAddCustomerModal() {
            // Reset form and set title
            document.getElementById('formModalTitle').textContent = 'Add New Customer';
            document.getElementById('customerForm').reset();
            document.getElementById('customerId').value = '';

            // Show password field for new customers
            document.getElementById('passwordField').style.display = 'block';

            // Set up action buttons
            const actionButtons = document.getElementById('formActionButtons');
            actionButtons.innerHTML = `
        <button type="button" class="action-btn" onclick="document.getElementById('customerFormModal').style.display='none'">
            <i class="fas fa-times"></i> Cancel
        </button>
        <button type="button" class="action-btn edit-btn" onclick="submitAddCustomer()">
            <i class="fas fa-plus"></i> Add Customer
        </button>
    `;

            // Show modal
            document.getElementById('customerFormModal').style.display = 'block';
        }

        // Function to show Edit Customer modal
        function editCustomer(customerId) {
            fetch(`/api/customers/${customerId}`)
                .then(response => response.json())
                .then(data => {
                    const customer = data.customer;

                    // Set form title and ID
                    document.getElementById('formModalTitle').textContent = 'Edit Customer';
                    document.getElementById('customerId').value = customer.id;

                    // Populate form fields
                    document.getElementById('firstName').value = customer.firstname || '';
                    document.getElementById('lastName').value = customer.lastname || '';
                    document.getElementById('email').value = customer.email || '';
                    document.getElementById('phone').value = customer.mobile || '';
                    document.getElementById('location').value = customer.location || '';
                    document.getElementById('profileUrl').value = customer.profileUrl || '';
                    document.getElementById('status').value = customer.status || 'Active';

                    // Hide password field for editing
                    document.getElementById('passwordField').style.display = 'none';

                    // Set up action buttons
                    const actionButtons = document.getElementById('formActionButtons');
                    actionButtons.innerHTML = `
                <button type="button" class="action-btn" onclick="document.getElementById('customerFormModal').style.display='none'">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button type="button" class="action-btn edit-btn" onclick="submitEditCustomer()">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            `;

                    // Show profile image preview if URL exists
                    if (customer.profileUrl) {
                        verifyProfileImage(customer.profileUrl);
                    }

                    // Show modal
                    document.getElementById('customerFormModal').style.display = 'block';
                })
                .catch(error => {
                    console.error('Error fetching customer data:', error);
                    alert('Failed to load customer data');
                });
        }

        // Function to submit new customer
        function submitAddCustomer() {
            const formData = {
                firstname: document.getElementById('firstName').value,
                lastname: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value,
                mobile: document.getElementById('phone').value,
                location: document.getElementById('location').value,
                profileUrl: document.getElementById('profileUrl').value,
                status: document.getElementById('status').value
            };
            console.log("Submitting form data:", formData); // Debug log

            fetch('/api/customers', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(err => {
                            console.error("Server response:", text); // Log the raw response
                            throw new Error(err.message || 'Failed to add customer');
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    alert('Customer added successfully!');
                    document.getElementById('customerFormModal').style.display = 'none';
                    window.location.reload();
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error adding customer: ' + error.message);
                });
        }

        // Function to submit customer edits
        function submitEditCustomer() {
            const customerId = document.getElementById('customerId').value;
            const formData = {
                firstname: document.getElementById('firstName').value,
                lastname: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                mobile: document.getElementById('phone').value,
                location: document.getElementById('location').value,
                profileUrl: document.getElementById('profileUrl').value,
                status: document.getElementById('status').value
            };


            fetch(`/api/customers/${customerId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
                .then(response => {
                    if (!response.ok) {
                        console.error("Server response:", text); // Log the raw response
                        return response.json().then(err => { throw new Error(err.message || 'Failed to update customer'); });
                    }
                    return response.json();
                })
                .then(data => {
                    alert('Customer updated successfully!');
                    document.getElementById('customerFormModal').style.display = 'none';
                    window.location.reload();
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error updating customer: ' + error.message);
                });
        }

        // View customer details
        function viewCustomerDetails(customerId) {
            fetch('/api/customers/' + customerId, {
                headers: {
                    'Accept': 'application/json'
                }
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    const customer = data.customer;
                    // Safely set all values with null checks
                    setElementText('detail-id', customer.id);
                    setElementText('detail-name',
                        (customer.firstname || '') + ' ' + (customer.lastname || ''));
                    setElementText('detail-email', customer.email || 'N/A');
                    setElementText('detail-phone', customer.mobile || 'N/A');
                    setElementText('detail-joined',
                        customer.createdAt ? new Date(customer.createdAt).toLocaleDateString() : 'N/A');

                    // Handle status badge safely
                    const statusBadge = document.getElementById('detail-status');
                    if (statusBadge) {
                        statusBadge.className = 'status-badge';
                        if (customer.status) {
                            statusBadge.classList.add(`status-${customer.status.toLowerCase()}`);
                            statusBadge.textContent = customer.status;
                        }
                    }

                    // Set booking stats
                    setElementText('detail-bookings', data.totalBookings || '0');
                    setElementText('detail-spent', '$' + (data.totalSpent?.toFixed(2) || '0.00'));

                    // Populate booking history
                    const bookingHistoryTable = document.getElementById('bookingHistory');
                    bookingHistoryTable.innerHTML = ''; // Clear existing rows

                    if (data.bookingHistory && data.bookingHistory.length > 0) {
                        data.bookingHistory.forEach(booking => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                        <td data-label="Booking ID">B${booking.id}</td>
                        <td data-label="Movie">${booking.movie || 'N/A'}</td>
                        <td data-label="Date">${booking.date ? formatDateOnly(booking.date) : 'N/A'}</td>
                        <td data-label="Time">${booking.date ? formatTimeOnly(booking.date) : 'N/A'}</td>
                        <td data-label="Seats">${booking.seats || 'N/A'}</td>
                        <td data-label="Amount">$${booking.amount?.toFixed(2) || '0.00'}</td>
                    `;
                            bookingHistoryTable.appendChild(row);
                        });
                    } else {
                        const row = document.createElement('tr');
                        row.innerHTML = '<td colspan="6" style="text-align: center;">No booking history found</td>';
                        bookingHistoryTable.appendChild(row);
                    }

                    document.getElementById('customerDetailsModal').style.display = 'block';
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error loading customer: ' + error.message);
                });
        }

        // Helper function to safely set text content
        function setElementText(id, text) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = text;
            }
        }

        // Ban customer
        function banCustomer(customerId) {
            document.getElementById('confirmTitle').textContent = 'Ban Customer';
            document.getElementById('confirmMessage').textContent = `Are you sure you want to ban customer ${customerId}? They will no longer be able to make bookings.`;
            document.getElementById('confirmActionBtn').textContent = 'Ban Customer';
            document.getElementById('confirmActionBtn').className = 'action-btn ban-btn';
            document.getElementById('confirmActionBtn').onclick = function () {
                updateCustomerStatus(customerId, 'Banned');
            };

            document.getElementById('confirmModal').style.display = 'block';
        }

        // Unban customer
        function unbanCustomer(customerId) {
            document.getElementById('confirmTitle').textContent = 'Unban Customer';
            document.getElementById('confirmMessage').textContent = `Are you sure you want to unban customer ${customerId}? They will be able to make bookings again.`;
            document.getElementById('confirmActionBtn').textContent = 'Unban Customer';
            document.getElementById('confirmActionBtn').className = 'action-btn edit-btn';
            document.getElementById('confirmActionBtn').onclick = function () {
                updateCustomerStatus(customerId, 'Active');
            };

            document.getElementById('confirmModal').style.display = 'block';
        }

        // Update customer status
        function updateCustomerStatus(customerId, status) {
            fetch('/api/customers/' + customerId + '/status', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ status: status })
            })
                .then(response => {
                    if (response.ok) {
                        alert(`Customer status updated to ${status}`);
                        window.location.reload(); // Refresh the page to see changes
                    } else {
                        throw new Error('Failed to update status');
                    }
                })
                .catch(error => {
                    console.error('Error updating customer status:', error);
                    alert('Failed to update customer status');
                })
                .finally(() => {
                    document.getElementById('confirmModal').style.display = 'none';
                });
        }

        // Apply filters to customer list
        function applyFilters() {
            const status = document.getElementById('statusFilter').value;
            const dateRange = document.getElementById('dateFilter').value;
            const sortBy = document.getElementById('sortBy').value;
            const searchTerm = document.getElementById('customerSearch').value.trim();

            // Show loading state
            const tableBody = document.querySelector('tbody');
            tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center;"><i class="fas fa-spinner fa-spin"></i> Loading customers...</td></tr>';

            // Build query parameters
            const params = new URLSearchParams();
            if (status !== 'all') params.append('status', status);
            if (dateRange !== 'all') params.append('dateRange', dateRange);
            if (sortBy !== 'newest') params.append('sortBy', sortBy);
            if (searchTerm) params.append('searchTerm', searchTerm);

            // Make API call
            fetch(`/api/customers/filter?${params.toString()}`)
                .then(response => response.json())
                .then(customers => {
                    updateCustomerTable(customers);
                })
                .catch(error => {
                    console.error('Error filtering customers:', error);
                    tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: red;">Error loading customers</td></tr>';
                });
        }

        // Update customer table with filtered results
        function updateCustomerTable(customers) {
            const tableBody = document.querySelector('tbody');

            if (!customers || customers.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center;">No customers found matching your search</td></tr>';
                return;
            }

            let html = '';
            customers.forEach(user => {
                html += `
            <tr>
                <td data-label="ID">${user.id}</td>
                <td data-label="Name">${user.firstname} ${user.lastname}</td>
                <td data-label="Email">${user.email}</td>
                <td data-label="Phone">${user.mobile}</td>
                <td data-label="Joined">${formatDate(user.createdAt)}</td>
                <td data-label="Status">
                    <span class="status-badge ${getStatusClass(user.status)}">
                        ${user.status}
                    </span>
                </td>
                <td data-label="Actions" class="customer-actions">
                    ${generateActionButtons(user)}
                </td>
            </tr>
        `;
            });

            tableBody.innerHTML = html;
        }

        // Helper function to format date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }

        // Helper function to get status class
        function getStatusClass(status) {
            return status === 'Active' ? 'status-active' :
                status === 'Banned' ? 'status-banned' : 'status-inactive';
        }

        // Helper function to generate action buttons
        function generateActionButtons(user) {
            return `
        <button class="action-btn view-btn" onclick="viewCustomerDetails('${user.id}')">
            <i class="fas fa-eye"></i> <span class="action-text">View</span>
        </button>
        <button class="action-btn edit-btn" onclick="editCustomer('${user.id}')">
            <i class="fas fa-edit"></i> <span class="action-text">Edit</span>
        </button>
        ${user.status === 'Active' ?
                    `<button class="action-btn ban-btn" onclick="banCustomer('${user.id}')">
                <i class="fas fa-ban"></i> <span class="action-text">Ban</span>
            </button>` :
                    `<button class="action-btn edit-btn" onclick="unbanCustomer('${user.id}')">
                <i class="fas fa-check"></i> <span class="action-text">Unban</span>
            </button>`}
    `;
        }

        // Password strength checker
        function checkPasswordStrength(password) {
            const strengthBar = document.getElementById('passwordStrengthBar');
            const strengthText = document.getElementById('passwordStrengthText');

            // Reset
            let strength = 0;
            strengthBar.style.width = '0%';
            strengthBar.style.backgroundColor = '#ff5252'; // Red

            // Check password length
            if (password.length >= 8) strength += 1;
            if (password.length >= 12) strength += 1;

            // Check for mixed case
            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength += 1;

            // Check for numbers
            if (/\d/.test(password)) strength += 1;

            // Check for special chars
            if (/[^a-zA-Z0-9]/.test(password)) strength += 1;

            // Update the strength bar and text
            let width = strength * 20;
            strengthBar.style.width = width + '%';

            if (strength <= 1) {
                strengthBar.style.backgroundColor = '#ff5252'; // Red
                strengthText.textContent = 'Password strength: Very Weak';
                strengthText.style.color = '#ff5252';
            } else if (strength <= 2) {
                strengthBar.style.backgroundColor = '#ff9800'; // Orange
                strengthText.textContent = 'Password strength: Weak';
                strengthText.style.color = '#ff9800';
            } else if (strength <= 3) {
                strengthBar.style.backgroundColor = '#ffeb3b'; // Yellow
                strengthText.textContent = 'Password strength: Moderate';
                strengthText.style.color = '#ff9800';
            } else if (strength <= 4) {
                strengthBar.style.backgroundColor = '#4caf50'; // Green
                strengthText.textContent = 'Password strength: Strong';
                strengthText.style.color = '#4caf50';
            } else {
                strengthBar.style.backgroundColor = '#2e7d32'; // Dark Green
                strengthText.textContent = 'Password strength: Very Strong';
                strengthText.style.color = '#2e7d32';
            }

            // Also check password match when password changes
            checkPasswordMatch();
        }

        // Password match checker
        function checkPasswordMatch() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const matchText = document.getElementById('passwordMatchText');

            if (password && confirmPassword) {
                if (password === confirmPassword) {
                    matchText.textContent = 'Passwords match!';
                    matchText.style.color = '#4caf50';
                } else {
                    matchText.textContent = 'Passwords do not match!';
                    matchText.style.color = '#ff5252';
                }
            } else {
                matchText.textContent = '';
            }
        }

        // Profile image verification
        function verifyProfileImage(url) {
            const preview = document.getElementById('profileImagePreview');
            const image = document.getElementById('profileImage');
            const status = document.getElementById('profileImageStatus');

            if (!url) {
                preview.style.display = 'none';
                return;
            }

            // Basic URL validation
            if (!url.match(/^https?:\/\/.+\..+/)) {
                preview.style.display = 'block';
                image.style.display = 'none';
                status.textContent = 'Invalid URL format';
                status.style.color = '#ff5252';
                return;
            }

            // Try to load the image
            preview.style.display = 'flex';
            image.style.display = 'block';
            status.textContent = 'Loading...';
            status.style.color = '#2196f3';

            // Create a new image to test loading
            const testImage = new Image();
            testImage.onload = function () {
                image.src = url;
                status.textContent = 'Image loaded successfully';
                status.style.color = '#4caf50';
            };
            testImage.onerror = function () {
                image.style.display = 'none';
                status.textContent = 'Failed to load image from URL';
                status.style.color = '#ff5252';
            };
            testImage.src = url;
        }

        // Update on resize
        window.addEventListener('resize', updateButtonText);

        // Responsive button text
        function updateButtonText() {
            const buttons = document.querySelectorAll('.btn-text, .action-text');
            if (window.innerWidth < 576) {
                buttons.forEach(btn => {
                    btn.style.display = 'none';
                });
            } else {
                buttons.forEach(btn => {
                    btn.style.display = 'inline';
                });
            }
        }

        // Initial check
        updateButtonText();
    </script>
</body>


</html>
